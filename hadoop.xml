<!--

RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Nov 04 05:53:31 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/MAPREDUCE-6704/MAPREDUCE-6704.xml?field=key&amp;field=summary
-->
<rss version="0.92">
<script/>
<channel>
<title>ASF JIRA</title>
<link>https://issues.apache.org/jira</link>
<description>This file is an XML representation of an issue</description>
<language>en-uk</language>
<build-info>
<version>6.3.4</version>
<build-number>6332</build-number>
<build-date>15-08-2014</build-date>
</build-info>
<item>
<title>
[MAPREDUCE-6704] Container fail to launch for mapred application
</title>
<link>
https://issues.apache.org/jira/browse/MAPREDUCE-6704
</link>
<project id="12310941" key="MAPREDUCE">Hadoop Map/Reduce</project>
<description>
<p>Container fail to launch for mapred application.<br/> As part for launch script <tt>HADOOP_MAPRED_HOME</tt> default value is not set .After <a href="https://github.com/apache/hadoop/commit/9d4d30243b0fc9630da51a2c17b543ef671d035c" class="external-link" rel="nofollow">https://github.com/apache/hadoop/commit/9d4d30243b0fc9630da51a2c17b543ef671d035c</a> <tt>HADOOP_MAPRED_HOME</tt> is not able to get from <tt>builder.environment()</tt> since <tt>DefaultContainerExecutor#buildCommandExecutor</tt> sets inherit to false.</p> <div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent"> <pre>16/05/02 09:16:05 INFO mapreduce.Job: Job job_1462155939310_0004 failed with state FAILED due to: Application application_1462155939310_0004 failed 2 times due to AM Container for appattempt_1462155939310_0004_000002 exited with exitCode: 1 Failing this attempt.Diagnostics: Exception from container-launch. Container id: container_1462155939310_0004_02_000001 Exit code: 1 Stack trace: ExitCodeException exitCode=1: at org.apache.hadoop.util.Shell.runCommand(Shell.java:946) at org.apache.hadoop.util.Shell.run(Shell.java:850) at org.apache.hadoop.util.Shell$ShellCommandExecutor.execute(Shell.java:1144) at org.apache.hadoop.yarn.server.nodemanager.DefaultContainerExecutor.launchContainer(DefaultContainerExecutor.java:227) at org.apache.hadoop.yarn.server.nodemanager.containermanager.launcher.ContainerLaunch.launchContainer(ContainerLaunch.java:385) at org.apache.hadoop.yarn.server.nodemanager.containermanager.launcher.ContainerLaunch.call(ContainerLaunch.java:281) at org.apache.hadoop.yarn.server.nodemanager.containermanager.launcher.ContainerLaunch.call(ContainerLaunch.java:89) at java.util.concurrent.FutureTask.run(FutureTask.java:266) at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) at java.lang.Thread.run(Thread.java:745) Container exited with a non-zero exit code 1. Last 4096 bytes of stderr : Java HotSpot(TM) 64-Bit Server VM warning: ignoring option UseSplitVerifier; support was removed in 8.0 Error: Could not find or load main class org.apache.hadoop.mapreduce.v2.app.MRAppMaster Container exited with a non-zero exit code 1. Last 4096 bytes of stderr : Java HotSpot(TM) 64-Bit Server VM warning: ignoring option UseSplitVerifier; support was removed in 8.0 </pre> </div></div>
</description>
<environment/>
<key id="12964291">MAPREDUCE-6704</key>
<summary>Container fail to launch for mapred application</summary>
<type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
<priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.png">Blocker</priority>
<status id="10002" iconUrl="https://issues.apache.org/jira/images/icons/statuses/document.png" description="A patch for this issue has been uploaded to JIRA by a contributor.">Patch Available</status>
<statusCategory id="4" key="indeterminate" colorName="yellow"/>
<resolution id="-1">Unresolved</resolution>
<assignee username="bibinchundatt">Bibin A Chundatt</assignee>
<reporter username="bibinchundatt">Bibin A Chundatt</reporter>
<labels></labels>
<created>Mon, 2 May 2016 13:18:25 +0000</created>
<updated>Fri, 4 Nov 2016 04:24:13 +0000</updated>
<due/>
<votes>1</votes>
<watches>27</watches>
<comments>
<comment id="15266592" author="naganarasimha" created="Mon, 2 May 2016 13:22:27 +0000">
<p>cc <a href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sarutak" class="user-hover" rel="sarutak">Kousuke Saruta</a> &amp; <a href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ajisakaa" class="user-hover" rel="ajisakaa">Akira Ajisaka</a></p>
</comment>
<comment id="15266903" author="sarutak" created="Mon, 2 May 2016 16:14:06 +0000">
<p>Thanks for the report <a href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=bibinchundatt" class="user-hover" rel="bibinchundatt">Bibin A Chundatt</a>.<br/> I've investigated a little this issue.<br/> I guess the change in <a href="https://github.com/apache/hadoop/commit/9d4d30243b0fc9630da51a2c17b543ef671d035c" class="external-link" rel="nofollow">https://github.com/apache/hadoop/commit/9d4d30243b0fc9630da51a2c17b543ef671d035c</a> causes this issue rather than <a href="https://issues.apache.org/jira/browse/YARN-4630" title="Remove useless boxing/unboxing code" class="issue-link" data-issue-key="YARN-4630"><del>YARN-4630</del></a> if the reason why the MR job fails is as you mention.</p>
</comment>
<comment id="15266929" author="bibinchundatt" created="Mon, 2 May 2016 16:32:10 +0000">
<p><a href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sarutak" class="user-hover" rel="sarutak">Kousuke Saruta</a><br/> Thank you for correcting me. Will update description too.<br/> cc <a href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rkanter" class="user-hover" rel="rkanter">Robert Kanter</a></p>
</comment>
<comment id="15266937" author="rkanter" created="Mon, 2 May 2016 16:38:32 +0000">
<p><tt>HADOOP_MAPRED_HOME</tt> shouldn't be necessary if you're running MR from a tarball in HDFS. If you need to add <tt>HADOOP_MAPRED_HOME</tt>, then I believe you should be able to add it to the classpath for MR jobs via <tt>mapreduce.admin.user.env</tt>.</p>
</comment>
<comment id="15266960" author="bibinchundatt" created="Mon, 2 May 2016 16:52:15 +0000">
<p>Currently we have changed the default behaviour. In <tt>launch_container.sh</tt> shouldn't we be adding the default value too rt??</p> <div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent"> <pre class="code-java"> export HADOOP_MAPRED_HOME={HADOOP_MAPRED_HOME:-xxxxx} </pre> </div></div> <p>So that without setting <tt>mapreduce.admin.user.env</tt> also we would get the old behaviour.</p>
</comment>
<comment id="15267150" author="rkanter" created="Mon, 2 May 2016 18:12:14 +0000">
<p>Containers shouldn't be relying on getting their environment variables from the NodeManager. For compatibility, the change in <a href="https://github.com/apache/hadoop/commit/9d4d30243b0fc9630da51a2c17b543ef671d035c" class="external-link" rel="nofollow">https://github.com/apache/hadoop/commit/9d4d30243b0fc9630da51a2c17b543ef671d035c</a> was only done in trunk. The equivalent change in branch-2, <a href="https://github.com/apache/hadoop/commit/ac8fb579c6058fec60caf30682f902413d68edf3" class="external-link" rel="nofollow">https://github.com/apache/hadoop/commit/ac8fb579c6058fec60caf30682f902413d68edf3</a>, does not remove <em>all</em> of the environment variables.</p>
</comment>
<comment id="15268641" author="bibinchundatt" created="Tue, 3 May 2016 12:49:15 +0000">
<p><a href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rkanter" class="user-hover" rel="rkanter">Robert Kanter</a><br/> Thank you for clarification<br/> As mentioned above after adding <tt>mapreduce.admin.user.env</tt> and <tt>yarn.app.mapreduce.am.env</tt> it works fine.<br/> IMHO it will be good to make it work without setting additional parameters too. Attaching patch for the same.</p> <p>Could you please point me to the JIRA for which change was done to understand further.</p>
</comment>
<comment id="15281756" author="sunilg" created="Thu, 12 May 2016 17:07:41 +0000">
<p><a href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=bibinchundatt" class="user-hover" rel="bibinchundatt">Bibin A Chundatt</a> / <a href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rkanter" class="user-hover" rel="rkanter">Robert Kanter</a></p> <p>Is it possible that we can set default value to <tt>mapreduce.admin.user.env</tt> and <tt>yarn.app.mapreduce.am.env</tt>. By default <tt>HADOOP_MAPRED_HOME</tt> can be set as HADOOP_HOME. I guess this can be helpful, and not feeling this as security issue. <a href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rkanter" class="user-hover" rel="rkanter">Robert Kanter</a>, do you any security issue if we set a default value?</p>
</comment>
<comment id="15284362" author="bibinchundatt" created="Mon, 16 May 2016 10:36:45 +0000">
<p><a href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sunilg" class="user-hover" rel="sunilg">Sunil G</a><br/> Yes,Was considering this as second solution. As per the offline discussion with <a href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rohithsharma" class="user-hover" rel="rohithsharma">Rohith Sharma K S</a> Yarn shouldn't have any MR-specific configs so setting the default value as <tt>HADOOP_COMMON_HOME</tt> for <tt>HADOOP_MAPRED_HOME</tt> should fix the problem.</p>
</comment>
<comment id="15285068" author="sjlee0" created="Mon, 16 May 2016 18:53:38 +0000">
<p><a href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=bibinchundatt" class="user-hover" rel="bibinchundatt">Bibin A Chundatt</a>, would you like to update the patch to implement the approach (setting HADOOP_MAPRED_HOME to HADOOP_COMMON_HOME)?</p> <p>One thing to note is that if the default is defined on the admin env and the user overrides it on the non-admin env things break because YARN would simply concatenate the values (see <a href="https://issues.apache.org/jira/browse/YARN-4789" title="Provide helpful exception for non-PATH-like conflict with admin.user.env" class="issue-link" data-issue-key="YARN-4789">YARN-4789</a> and <a href="https://issues.apache.org/jira/browse/MAPREDUCE-6491" title="Environment variable handling assumes values should be appended" class="issue-link" data-issue-key="MAPREDUCE-6491">MAPREDUCE-6491</a>). So until that is fixed it might be better to use <tt>mapred.child.env</tt> over <tt>mapreduce.admin.user.env</tt>.</p>
</comment>
<comment id="15285095" author="naganarasimha" created="Mon, 16 May 2016 19:02:54 +0000">
<p>we should move this to Mapred project, if fix is on map reduce related configuration/env</p>
</comment>
<comment id="15286261" author="bibinchundatt" created="Tue, 17 May 2016 09:08:13 +0000">
<p><a href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sjlee0" class="user-hover" rel="sjlee0">Sangjin Lee</a>/<a href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Naganarasimha" class="user-hover" rel="Naganarasimha">Naganarasimha G R</a><br/> Will update the patch soon after moving to mapreduce</p>
</comment>
<comment id="15324136" author="hadoopqa" created="Fri, 10 Jun 2016 09:29:47 +0000">
<table class='confluenceTable'><tbody> <tr> <td class='confluenceTd'> <img class="emoticon" src="https://issues.apache.org/jira/images/icons/emoticons/error.gif" height="16" width="16" align="absmiddle" alt="" border="0"/> <b><font color="red">-1 overall</font></b> </td> </tr> </tbody></table> <p><br class="atl-forced-newline" /> <br class="atl-forced-newline" /></p> <table class='confluenceTable'><tbody> <tr> <th class='confluenceTh'> Vote </th> <th class='confluenceTh'> Subsystem </th> <th class='confluenceTh'> Runtime </th> <th class='confluenceTh'> Comment </th> </tr> <tr> <td class='confluenceTd'> <font color="blue">0</font> </td> <td class='confluenceTd'> <font color="blue"> reexec </font> </td> <td class='confluenceTd'> <font color="blue"> 0m 33s </font> </td> <td class='confluenceTd'> <font color="blue"> Docker mode activated. </font> </td> </tr> <tr> <td class='confluenceTd'> <font color="green">+1</font> </td> <td class='confluenceTd'> <font color="green"> @author </font> </td> <td class='confluenceTd'> <font color="green"> 0m 0s </font> </td> <td class='confluenceTd'> <font color="green"> The patch does not contain any @author tags. </font> </td> </tr> <tr> <td class='confluenceTd'> <font color="red">-1</font> </td> <td class='confluenceTd'> <font color="red"> test4tests </font> </td> <td class='confluenceTd'> <font color="red"> 0m 0s </font> </td> <td class='confluenceTd'> <font color="red"> The patch doesn't appear to include any new or modified tests. Please justify why no new tests are needed for this patch. Also please list what manual steps were performed to verify this patch. </font> </td> </tr> <tr> <td class='confluenceTd'> <font color="blue">0</font> </td> <td class='confluenceTd'> <font color="blue"> mvndep </font> </td> <td class='confluenceTd'> <font color="blue"> 0m 7s </font> </td> <td class='confluenceTd'> <font color="blue"> Maven dependency ordering for branch </font> </td> </tr> <tr> <td class='confluenceTd'> <font color="green">+1</font> </td> <td class='confluenceTd'> <font color="green"> mvninstall </font> </td> <td class='confluenceTd'> <font color="green"> 6m 41s </font> </td> <td class='confluenceTd'> <font color="green"> trunk passed </font> </td> </tr> <tr> <td class='confluenceTd'> <font color="green">+1</font> </td> <td class='confluenceTd'> <font color="green"> compile </font> </td> <td class='confluenceTd'> <font color="green"> 1m 34s </font> </td> <td class='confluenceTd'> <font color="green"> trunk passed </font> </td> </tr> <tr> <td class='confluenceTd'> <font color="green">+1</font> </td> <td class='confluenceTd'> <font color="green"> checkstyle </font> </td> <td class='confluenceTd'> <font color="green"> 0m 34s </font> </td> <td class='confluenceTd'> <font color="green"> trunk passed </font> </td> </tr> <tr> <td class='confluenceTd'> <font color="green">+1</font> </td> <td class='confluenceTd'> <font color="green"> mvnsite </font> </td> <td class='confluenceTd'> <font color="green"> 0m 54s </font> </td> <td class='confluenceTd'> <font color="green"> trunk passed </font> </td> </tr> <tr> <td class='confluenceTd'> <font color="green">+1</font> </td> <td class='confluenceTd'> <font color="green"> mvneclipse </font> </td> <td class='confluenceTd'> <font color="green"> 0m 27s </font> </td> <td class='confluenceTd'> <font color="green"> trunk passed </font> </td> </tr> <tr> <td class='confluenceTd'> <font color="green">+1</font> </td> <td class='confluenceTd'> <font color="green"> findbugs </font> </td> <td class='confluenceTd'> <font color="green"> 1m 26s </font> </td> <td class='confluenceTd'> <font color="green"> trunk passed </font> </td> </tr> <tr> <td class='confluenceTd'> <font color="green">+1</font> </td> <td class='confluenceTd'> <font color="green"> javadoc </font> </td> <td class='confluenceTd'> <font color="green"> 0m 40s </font> </td> <td class='confluenceTd'> <font color="green"> trunk passed </font> </td> </tr> <tr> <td class='confluenceTd'> <font color="blue">0</font> </td> <td class='confluenceTd'> <font color="blue"> mvndep </font> </td> <td class='confluenceTd'> <font color="blue"> 0m 7s </font> </td> <td class='confluenceTd'> <font color="blue"> Maven dependency ordering for patch </font> </td> </tr> <tr> <td class='confluenceTd'> <font color="green">+1</font> </td> <td class='confluenceTd'> <font color="green"> mvninstall </font> </td> <td class='confluenceTd'> <font color="green"> 0m 43s </font> </td> <td class='confluenceTd'> <font color="green"> the patch passed </font> </td> </tr> <tr> <td class='confluenceTd'> <font color="green">+1</font> </td> <td class='confluenceTd'> <font color="green"> compile </font> </td> <td class='confluenceTd'> <font color="green"> 1m 35s </font> </td> <td class='confluenceTd'> <font color="green"> the patch passed </font> </td> </tr> <tr> <td class='confluenceTd'> <font color="green">+1</font> </td> <td class='confluenceTd'> <font color="green"> javac </font> </td> <td class='confluenceTd'> <font color="green"> 1m 35s </font> </td> <td class='confluenceTd'> <font color="green"> the patch passed </font> </td> </tr> <tr> <td class='confluenceTd'> <font color="red">-1</font> </td> <td class='confluenceTd'> <font color="red"> checkstyle </font> </td> <td class='confluenceTd'> <font color="red"> 0m 31s </font> </td> <td class='confluenceTd'> <font color="red"> hadoop-mapreduce-project/hadoop-mapreduce-client: The patch generated 2 new + 621 unchanged - 2 fixed = 623 total (was 623) </font> </td> </tr> <tr> <td class='confluenceTd'> <font color="green">+1</font> </td> <td class='confluenceTd'> <font color="green"> mvnsite </font> </td> <td class='confluenceTd'> <font color="green"> 0m 49s </font> </td> <td class='confluenceTd'> <font color="green"> the patch passed </font> </td> </tr> <tr> <td class='confluenceTd'> <font color="green">+1</font> </td> <td class='confluenceTd'> <font color="green"> mvneclipse </font> </td> <td class='confluenceTd'> <font color="green"> 0m 21s </font> </td> <td class='confluenceTd'> <font color="green"> the patch passed </font> </td> </tr> <tr> <td class='confluenceTd'> <font color="red">-1</font> </td> <td class='confluenceTd'> <font color="red"> whitespace </font> </td> <td class='confluenceTd'> <font color="red"> 0m 0s </font> </td> <td class='confluenceTd'> <font color="red"> The patch has 20 line(s) that end in whitespace. Use git apply --whitespace=fix. </font> </td> </tr> <tr> <td class='confluenceTd'> <font color="green">+1</font> </td> <td class='confluenceTd'> <font color="green"> findbugs </font> </td> <td class='confluenceTd'> <font color="green"> 1m 33s </font> </td> <td class='confluenceTd'> <font color="green"> the patch passed </font> </td> </tr> <tr> <td class='confluenceTd'> <font color="green">+1</font> </td> <td class='confluenceTd'> <font color="green"> javadoc </font> </td> <td class='confluenceTd'> <font color="green"> 0m 32s </font> </td> <td class='confluenceTd'> <font color="green"> the patch passed </font> </td> </tr> <tr> <td class='confluenceTd'> <font color="green">+1</font> </td> <td class='confluenceTd'> <font color="green"> unit </font> </td> <td class='confluenceTd'> <font color="green"> 2m 1s </font> </td> <td class='confluenceTd'> <font color="green"> hadoop-mapreduce-client-core in the patch passed. </font> </td> </tr> <tr> <td class='confluenceTd'> <font color="green">+1</font> </td> <td class='confluenceTd'> <font color="green"> unit </font> </td> <td class='confluenceTd'> <font color="green"> 8m 48s </font> </td> <td class='confluenceTd'> <font color="green"> hadoop-mapreduce-client-app in the patch passed. </font> </td> </tr> <tr> <td class='confluenceTd'> <font color="green">+1</font> </td> <td class='confluenceTd'> <font color="green"> asflicense </font> </td> <td class='confluenceTd'> <font color="green"> 0m 18s </font> </td> <td class='confluenceTd'> <font color="green"> The patch does not generate ASF License warnings. </font> </td> </tr> <tr> <td class='confluenceTd'> <font color="black"></font> </td> <td class='confluenceTd'> <font color="black"> </font> </td> <td class='confluenceTd'> <font color="black"> 31m 0s </font> </td> <td class='confluenceTd'> <font color="black"> </font> </td> </tr> </tbody></table> <p><br class="atl-forced-newline" /> <br class="atl-forced-newline" /></p> <table class='confluenceTable'><tbody> <tr> <th class='confluenceTh'> Subsystem </th> <th class='confluenceTh'> Report/Notes </th> </tr> <tr> <td class='confluenceTd'> Docker </td> <td class='confluenceTd'> Image:yetus/hadoop:2c91fd8 </td> </tr> <tr> <td class='confluenceTd'> JIRA Patch URL </td> <td class='confluenceTd'> <a href="https://issues.apache.org/jira/secure/attachment/12809399/0001-MAPREDUCE-6704.patch" class="external-link" rel="nofollow">https://issues.apache.org/jira/secure/attachment/12809399/0001-MAPREDUCE-6704.patch</a> </td> </tr> <tr> <td class='confluenceTd'> JIRA Issue </td> <td class='confluenceTd'> <a href="https://issues.apache.org/jira/browse/MAPREDUCE-6704" title="Container fail to launch for mapred application" class="issue-link" data-issue-key="MAPREDUCE-6704">MAPREDUCE-6704</a> </td> </tr> <tr> <td class='confluenceTd'> Optional Tests </td> <td class='confluenceTd'> asflicense compile javac javadoc mvninstall mvnsite unit findbugs checkstyle </td> </tr> <tr> <td class='confluenceTd'> uname </td> <td class='confluenceTd'> Linux 2887d3993199 3.13.0-36-lowlatency #63-Ubuntu SMP PREEMPT Wed Sep 3 21:56:12 UTC 2014 x86_64 x86_64 x86_64 GNU/Linux </td> </tr> <tr> <td class='confluenceTd'> Build tool </td> <td class='confluenceTd'> maven </td> </tr> <tr> <td class='confluenceTd'> Personality </td> <td class='confluenceTd'> /testptch/hadoop/patchprocess/precommit/personality/provided.sh </td> </tr> <tr> <td class='confluenceTd'> git revision </td> <td class='confluenceTd'> trunk / 9581fb7 </td> </tr> <tr> <td class='confluenceTd'> Default Java </td> <td class='confluenceTd'> 1.8.0_91 </td> </tr> <tr> <td class='confluenceTd'> findbugs </td> <td class='confluenceTd'> v3.0.0 </td> </tr> <tr> <td class='confluenceTd'> checkstyle </td> <td class='confluenceTd'> <a href="https://builds.apache.org/job/PreCommit-MAPREDUCE-Build/6548/artifact/patchprocess/diff-checkstyle-hadoop-mapreduce-project_hadoop-mapreduce-client.txt" class="external-link" rel="nofollow">https://builds.apache.org/job/PreCommit-MAPREDUCE-Build/6548/artifact/patchprocess/diff-checkstyle-hadoop-mapreduce-project_hadoop-mapreduce-client.txt</a> </td> </tr> <tr> <td class='confluenceTd'> whitespace </td> <td class='confluenceTd'> <a href="https://builds.apache.org/job/PreCommit-MAPREDUCE-Build/6548/artifact/patchprocess/whitespace-eol.txt" class="external-link" rel="nofollow">https://builds.apache.org/job/PreCommit-MAPREDUCE-Build/6548/artifact/patchprocess/whitespace-eol.txt</a> </td> </tr> <tr> <td class='confluenceTd'> Test Results </td> <td class='confluenceTd'> <a href="https://builds.apache.org/job/PreCommit-MAPREDUCE-Build/6548/testReport/" class="external-link" rel="nofollow">https://builds.apache.org/job/PreCommit-MAPREDUCE-Build/6548/testReport/</a> </td> </tr> <tr> <td class='confluenceTd'> modules </td> <td class='confluenceTd'> C: hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-core hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-app U: hadoop-mapreduce-project/hadoop-mapreduce-client </td> </tr> <tr> <td class='confluenceTd'> Console output </td> <td class='confluenceTd'> <a href="https://builds.apache.org/job/PreCommit-MAPREDUCE-Build/6548/console" class="external-link" rel="nofollow">https://builds.apache.org/job/PreCommit-MAPREDUCE-Build/6548/console</a> </td> </tr> <tr> <td class='confluenceTd'> Powered by </td> <td class='confluenceTd'> Apache Yetus 0.3.0 <a href="http://yetus.apache.org" class="external-link" rel="nofollow">http://yetus.apache.org</a> </td> </tr> </tbody></table> <p>This message was automatically generated.</p>
</comment>
<comment id="15350917" author="ozawa" created="Mon, 27 Jun 2016 12:33:58 +0000">
<p><a href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=bibinchundatt" class="user-hover" rel="bibinchundatt">Bibin A Chundatt</a> thanks for your contribution.</p> <blockquote> <p>+ "HADOOP_MAPRED_HOME=" + Apps.crossPlatformify("HADOOP_COMMON_HOME");</p></blockquote> <p>Why not making {{ "HADOOP_MAPRED_HOME="Apps.crossPlatformify("HADOOP_MAPRED_HOME");}}? I think it's more straight forward and better to understand its behaviour.</p>
</comment>
<comment id="15350922" author="ozawa" created="Mon, 27 Jun 2016 12:37:32 +0000">
<p>Also, after changing default value of properties, could you update ./hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-core/src/main/resources/mapred-default.xml?</p>
</comment>
<comment id="15351969" author="ajisakaa" created="Mon, 27 Jun 2016 22:30:37 +0000">
<blockquote><p>By default HADOOP_MAPRED_HOME can be set as HADOOP_HOME. I guess this can be helpful, and not feeling this as security issue.</p></blockquote> <p>Agreed. If we are going to do this, we need to revert the documentation of <a href="https://issues.apache.org/jira/browse/MAPREDUCE-6702" title="TestMiniMRChildTask.testTaskEnv and TestMiniMRChildTask.testTaskOldEnv are failing" class="issue-link" data-issue-key="MAPREDUCE-6702"><del>MAPREDUCE-6702</del></a> and update the release note. Would you revert the documentation change in this issue?</p>
</comment>
<comment id="15351973" author="ozawa" created="Mon, 27 Jun 2016 22:36:57 +0000">
<p><a href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ajisakaa" class="user-hover" rel="ajisakaa">Akira Ajisaka</a> </p> <blockquote> <p>Agreed. If we are going to do this, we need to revert the documentation of <a href="https://issues.apache.org/jira/browse/MAPREDUCE-6702" title="TestMiniMRChildTask.testTaskEnv and TestMiniMRChildTask.testTaskOldEnv are failing" class="issue-link" data-issue-key="MAPREDUCE-6702"><del>MAPREDUCE-6702</del></a> and update the release note. Would you revert the documentation change in this issue?</p></blockquote> <p>My previous comment means I don't agree with the point. My thought is that it is not straight forward, and confusing. Hence, I think it should be {{ "HADOOP_MAPRED_HOME="Apps.crossPlatformify("HADOOP_MAPRED_HOME");}}. Could you tell me your thoughts?</p>
</comment>
<comment id="15351996" author="ajisakaa" created="Mon, 27 Jun 2016 22:53:34 +0000">
<p>IIUC, <tt>"HADOOP_MAPRED_HOME=" + Apps.crossPlatformify("HADOOP_MAPRED_HOME")</tt> does not fix the problem because <tt>HADOOP_MAPRED_HOME</tt> is not in <tt>yarn.nodemanager.env-whitelist</tt> by default (i.e. Container cannot inherit the NodeManager's environment variable <tt>HADOOP_MAPRED_HOME</tt> by default).</p>
</comment>
<comment id="15352946" author="aw" created="Tue, 28 Jun 2016 13:02:58 +0000">
<p>There has been no guarantee that HADOOP_MAPRED_HOME is the same as HADOOP_COMMON_HOME since 0.22. See libexec/hadoop-layout.sh.example.</p>
</comment>
<comment id="15410998" author="bibinchundatt" created="Sun, 7 Aug 2016 17:08:26 +0000">
<p><a href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=aw" class="user-hover" rel="aw">Allen Wittenauer</a>/<a href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ajisakaa" class="user-hover" rel="ajisakaa">Akira Ajisaka</a><br/> Sorry for the delay.</p> <p>As already mentioned the <tt>HADOOP_MAPRED_HOME</tt> is not part of env since not inherited to launcher.Adding </p> <div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent"> <pre class="code-java"> yarn.nodemanager.env-whitelist=<span class="code-quote">"JAVA_HOME,HADOOP_COMMON_HOME,HADOOP_HDFS_HOME,HADOOP_CONF_DIR,CLASSPATH_PREPEND_DISTCACHE,HADOOP_YARN_HOME,HADOOP_MAPRED_HOME"</span> </pre> </div></div> <p>in yarn-site.xml of NM does solve the problem. But since its a mapreduce property its not correct to add to the whitelist of yarn .</p> <p>IIUU <tt>HADOOP_MAPRED_HOME</tt> for default installation will be same as <tt>HADOOP_COMMON_HOME</tt> .<br/> For layout change we can configure explicity mapred.child.env paths.</p> <p>Till jira is fixed ,to make mapreduce job run add params as below</p> <div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent"> <pre class="code-java"> -Dmapred.child.env=<span class="code-quote">"HADOOP_MAPRED_HOME={{HADOOP_COMMON_HOME}}"</span> -Dyarn.app.mapreduce.am.env=<span class="code-quote">"HADOOP_MAPRED_HOME={{HADOOP_COMMON_HOME}}"</span> </pre> </div></div> <p>Open to any other solution.</p>
</comment>
<comment id="15411015" author="aw" created="Sun, 7 Aug 2016 17:49:46 +0000">
<blockquote><p>But since its a mapreduce property its not correct to add to the whitelist of yarn .</p></blockquote> <p>Why can't MR add it itself?</p> <blockquote><p>But since its a mapreduce property its not correct to add to the whitelist of yarn .</p></blockquote> <p>Who cares? It's all Apache Hadoop. Users have an expectation that this stuff will work <b>out of the box</b> and be <b>consistent</b>. They aren't going to say "Oh, of course this is completely broken! That part over there is YARN and that part over there is MAPREDUCE!"</p> <blockquote><p>IIUU HADOOP_MAPRED_HOME for default installation will be same as HADOOP_COMMON_HOME .</p></blockquote> <p>It's irrelevant. HADOOP_MAPRED_HOME is where the mapred stuff is guaranteed to be. There is no guarantee that HADOOP_COMMON_HOME is going to work. That's why there is a separate variable for it instead of just using HADOOP_COMMON_HOME everywhere. Either this should be HADOOP_MAPRED_HOME or set nothing at all.</p>
</comment>
<comment id="15411208" author="bibinchundatt" created="Mon, 8 Aug 2016 03:08:40 +0000">
<p>0001-<a href="https://issues.apache.org/jira/browse/MAPREDUCE-6704" title="Container fail to launch for mapred application" class="issue-link" data-issue-key="MAPREDUCE-6704">YARN-5026</a>.patch implementation is based on <tt>HADOOP_MAPRED_HOME</tt> added to whitelist.</p>
</comment>
<comment id="15508908" author="tangzhankun" created="Wed, 21 Sep 2016 06:22:22 +0000">
<p>I encountered this issue too. Quite shocked that commit "9d4d30243b0fc" get merged without basic MRv2 test and even no YARN JIRA for it!<br/> And it's strange that I still fail to run MRv2 application as well as Dockerized MRv2 application after tried the temporary solution mentioned by Bibin A Chundatt. YARN patch also not works for me.</p>
</comment>
<comment id="15509009" author="bibinchundatt" created="Wed, 21 Sep 2016 07:09:30 +0000">
<p><a href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tangzhankun" class="user-hover" rel="tangzhankun">Zhankun Tang</a></p> <p>In nodemanager we can add the below config. Last time i checked below solution was working fine.</p> <p>yarn.nodemanager.env-whitelist=<br/> "JAVA_HOME,HADOOP_COMMON_HOME,HADOOP_HDFS_HOME,HADOOP_CONF_DIR,CLASSPATH_PREPEND_DISTCACHE,HADOOP_YARN_HOME,HADOOP_MAPRED_HOME"</p>
</comment>
<comment id="15509046" author="hadoopqa" created="Wed, 21 Sep 2016 07:25:52 +0000">
<table class='confluenceTable'><tbody> <tr> <td class='confluenceTd'> <img class="emoticon" src="https://issues.apache.org/jira/images/icons/emoticons/error.gif" height="16" width="16" align="absmiddle" alt="" border="0"/> <b><font color="red">-1 overall</font></b> </td> </tr> </tbody></table> <p><br class="atl-forced-newline" /> <br class="atl-forced-newline" /></p> <table class='confluenceTable'><tbody> <tr> <th class='confluenceTh'> Vote </th> <th class='confluenceTh'> Subsystem </th> <th class='confluenceTh'> Runtime </th> <th class='confluenceTh'> Comment </th> </tr> <tr> <td class='confluenceTd'> <font color="blue">0</font> </td> <td class='confluenceTd'> <font color="blue"> reexec </font> </td> <td class='confluenceTd'> <font color="blue"> 0m 14s </font> </td> <td class='confluenceTd'> <font color="blue"> Docker mode activated. </font> </td> </tr> <tr> <td class='confluenceTd'> <font color="green">+1</font> </td> <td class='confluenceTd'> <font color="green"> @author </font> </td> <td class='confluenceTd'> <font color="green"> 0m 0s </font> </td> <td class='confluenceTd'> <font color="green"> The patch does not contain any @author tags. </font> </td> </tr> <tr> <td class='confluenceTd'> <font color="red">-1</font> </td> <td class='confluenceTd'> <font color="red"> test4tests </font> </td> <td class='confluenceTd'> <font color="red"> 0m 0s </font> </td> <td class='confluenceTd'> <font color="red"> The patch doesn't appear to include any new or modified tests. Please justify why no new tests are needed for this patch. Also please list what manual steps were performed to verify this patch. </font> </td> </tr> <tr> <td class='confluenceTd'> <font color="blue">0</font> </td> <td class='confluenceTd'> <font color="blue"> mvndep </font> </td> <td class='confluenceTd'> <font color="blue"> 0m 8s </font> </td> <td class='confluenceTd'> <font color="blue"> Maven dependency ordering for branch </font> </td> </tr> <tr> <td class='confluenceTd'> <font color="green">+1</font> </td> <td class='confluenceTd'> <font color="green"> mvninstall </font> </td> <td class='confluenceTd'> <font color="green"> 6m 58s </font> </td> <td class='confluenceTd'> <font color="green"> trunk passed </font> </td> </tr> <tr> <td class='confluenceTd'> <font color="green">+1</font> </td> <td class='confluenceTd'> <font color="green"> compile </font> </td> <td class='confluenceTd'> <font color="green"> 1m 33s </font> </td> <td class='confluenceTd'> <font color="green"> trunk passed </font> </td> </tr> <tr> <td class='confluenceTd'> <font color="green">+1</font> </td> <td class='confluenceTd'> <font color="green"> checkstyle </font> </td> <td class='confluenceTd'> <font color="green"> 0m 33s </font> </td> <td class='confluenceTd'> <font color="green"> trunk passed </font> </td> </tr> <tr> <td class='confluenceTd'> <font color="green">+1</font> </td> <td class='confluenceTd'> <font color="green"> mvnsite </font> </td> <td class='confluenceTd'> <font color="green"> 0m 55s </font> </td> <td class='confluenceTd'> <font color="green"> trunk passed </font> </td> </tr> <tr> <td class='confluenceTd'> <font color="green">+1</font> </td> <td class='confluenceTd'> <font color="green"> mvneclipse </font> </td> <td class='confluenceTd'> <font color="green"> 0m 28s </font> </td> <td class='confluenceTd'> <font color="green"> trunk passed </font> </td> </tr> <tr> <td class='confluenceTd'> <font color="green">+1</font> </td> <td class='confluenceTd'> <font color="green"> findbugs </font> </td> <td class='confluenceTd'> <font color="green"> 1m 24s </font> </td> <td class='confluenceTd'> <font color="green"> trunk passed </font> </td> </tr> <tr> <td class='confluenceTd'> <font color="green">+1</font> </td> <td class='confluenceTd'> <font color="green"> javadoc </font> </td> <td class='confluenceTd'> <font color="green"> 0m 36s </font> </td> <td class='confluenceTd'> <font color="green"> trunk passed </font> </td> </tr> <tr> <td class='confluenceTd'> <font color="blue">0</font> </td> <td class='confluenceTd'> <font color="blue"> mvndep </font> </td> <td class='confluenceTd'> <font color="blue"> 0m 8s </font> </td> <td class='confluenceTd'> <font color="blue"> Maven dependency ordering for patch </font> </td> </tr> <tr> <td class='confluenceTd'> <font color="green">+1</font> </td> <td class='confluenceTd'> <font color="green"> mvninstall </font> </td> <td class='confluenceTd'> <font color="green"> 0m 43s </font> </td> <td class='confluenceTd'> <font color="green"> the patch passed </font> </td> </tr> <tr> <td class='confluenceTd'> <font color="green">+1</font> </td> <td class='confluenceTd'> <font color="green"> compile </font> </td> <td class='confluenceTd'> <font color="green"> 1m 29s </font> </td> <td class='confluenceTd'> <font color="green"> the patch passed </font> </td> </tr> <tr> <td class='confluenceTd'> <font color="green">+1</font> </td> <td class='confluenceTd'> <font color="green"> javac </font> </td> <td class='confluenceTd'> <font color="green"> 1m 29s </font> </td> <td class='confluenceTd'> <font color="green"> the patch passed </font> </td> </tr> <tr> <td class='confluenceTd'> <font color="red">-1</font> </td> <td class='confluenceTd'> <font color="red"> checkstyle </font> </td> <td class='confluenceTd'> <font color="red"> 0m 31s </font> </td> <td class='confluenceTd'> <font color="red"> hadoop-mapreduce-project/hadoop-mapreduce-client: The patch generated 2 new + 622 unchanged - 2 fixed = 624 total (was 624) </font> </td> </tr> <tr> <td class='confluenceTd'> <font color="green">+1</font> </td> <td class='confluenceTd'> <font color="green"> mvnsite </font> </td> <td class='confluenceTd'> <font color="green"> 0m 51s </font> </td> <td class='confluenceTd'> <font color="green"> the patch passed </font> </td> </tr> <tr> <td class='confluenceTd'> <font color="green">+1</font> </td> <td class='confluenceTd'> <font color="green"> mvneclipse </font> </td> <td class='confluenceTd'> <font color="green"> 0m 23s </font> </td> <td class='confluenceTd'> <font color="green"> the patch passed </font> </td> </tr> <tr> <td class='confluenceTd'> <font color="green">+1</font> </td> <td class='confluenceTd'> <font color="green"> whitespace </font> </td> <td class='confluenceTd'> <font color="green"> 0m 0s </font> </td> <td class='confluenceTd'> <font color="green"> The patch has no whitespace issues. </font> </td> </tr> <tr> <td class='confluenceTd'> <font color="green">+1</font> </td> <td class='confluenceTd'> <font color="green"> findbugs </font> </td> <td class='confluenceTd'> <font color="green"> 1m 36s </font> </td> <td class='confluenceTd'> <font color="green"> the patch passed </font> </td> </tr> <tr> <td class='confluenceTd'> <font color="green">+1</font> </td> <td class='confluenceTd'> <font color="green"> javadoc </font> </td> <td class='confluenceTd'> <font color="green"> 0m 31s </font> </td> <td class='confluenceTd'> <font color="green"> the patch passed </font> </td> </tr> <tr> <td class='confluenceTd'> <font color="green">+1</font> </td> <td class='confluenceTd'> <font color="green"> unit </font> </td> <td class='confluenceTd'> <font color="green"> 2m 2s </font> </td> <td class='confluenceTd'> <font color="green"> hadoop-mapreduce-client-core in the patch passed. </font> </td> </tr> <tr> <td class='confluenceTd'> <font color="green">+1</font> </td> <td class='confluenceTd'> <font color="green"> unit </font> </td> <td class='confluenceTd'> <font color="green"> 8m 54s </font> </td> <td class='confluenceTd'> <font color="green"> hadoop-mapreduce-client-app in the patch passed. </font> </td> </tr> <tr> <td class='confluenceTd'> <font color="green">+1</font> </td> <td class='confluenceTd'> <font color="green"> asflicense </font> </td> <td class='confluenceTd'> <font color="green"> 0m 18s </font> </td> <td class='confluenceTd'> <font color="green"> The patch does not generate ASF License warnings. </font> </td> </tr> <tr> <td class='confluenceTd'> <font color="black"></font> </td> <td class='confluenceTd'> <font color="black"> </font> </td> <td class='confluenceTd'> <font color="black"> 30m 58s </font> </td> <td class='confluenceTd'> <font color="black"> </font> </td> </tr> </tbody></table> <p><br class="atl-forced-newline" /> <br class="atl-forced-newline" /></p> <table class='confluenceTable'><tbody> <tr> <th class='confluenceTh'> Subsystem </th> <th class='confluenceTh'> Report/Notes </th> </tr> <tr> <td class='confluenceTd'> Docker </td> <td class='confluenceTd'> Image:yetus/hadoop:9560f25 </td> </tr> <tr> <td class='confluenceTd'> JIRA Patch URL </td> <td class='confluenceTd'> <a href="https://issues.apache.org/jira/secure/attachment/12809399/0001-MAPREDUCE-6704.patch" class="external-link" rel="nofollow">https://issues.apache.org/jira/secure/attachment/12809399/0001-MAPREDUCE-6704.patch</a> </td> </tr> <tr> <td class='confluenceTd'> JIRA Issue </td> <td class='confluenceTd'> <a href="https://issues.apache.org/jira/browse/MAPREDUCE-6704" title="Container fail to launch for mapred application" class="issue-link" data-issue-key="MAPREDUCE-6704">MAPREDUCE-6704</a> </td> </tr> <tr> <td class='confluenceTd'> Optional Tests </td> <td class='confluenceTd'> asflicense compile javac javadoc mvninstall mvnsite unit findbugs checkstyle </td> </tr> <tr> <td class='confluenceTd'> uname </td> <td class='confluenceTd'> Linux a9335e2f557f 3.13.0-93-generic #140-Ubuntu SMP Mon Jul 18 21:21:05 UTC 2016 x86_64 x86_64 x86_64 GNU/Linux </td> </tr> <tr> <td class='confluenceTd'> Build tool </td> <td class='confluenceTd'> maven </td> </tr> <tr> <td class='confluenceTd'> Personality </td> <td class='confluenceTd'> /testptch/hadoop/patchprocess/precommit/personality/provided.sh </td> </tr> <tr> <td class='confluenceTd'> git revision </td> <td class='confluenceTd'> trunk / 964e546 </td> </tr> <tr> <td class='confluenceTd'> Default Java </td> <td class='confluenceTd'> 1.8.0_101 </td> </tr> <tr> <td class='confluenceTd'> findbugs </td> <td class='confluenceTd'> v3.0.0 </td> </tr> <tr> <td class='confluenceTd'> checkstyle </td> <td class='confluenceTd'> <a href="https://builds.apache.org/job/PreCommit-MAPREDUCE-Build/6730/artifact/patchprocess/diff-checkstyle-hadoop-mapreduce-project_hadoop-mapreduce-client.txt" class="external-link" rel="nofollow">https://builds.apache.org/job/PreCommit-MAPREDUCE-Build/6730/artifact/patchprocess/diff-checkstyle-hadoop-mapreduce-project_hadoop-mapreduce-client.txt</a> </td> </tr> <tr> <td class='confluenceTd'> Test Results </td> <td class='confluenceTd'> <a href="https://builds.apache.org/job/PreCommit-MAPREDUCE-Build/6730/testReport/" class="external-link" rel="nofollow">https://builds.apache.org/job/PreCommit-MAPREDUCE-Build/6730/testReport/</a> </td> </tr> <tr> <td class='confluenceTd'> modules </td> <td class='confluenceTd'> C: hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-core hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-app U: hadoop-mapreduce-project/hadoop-mapreduce-client </td> </tr> <tr> <td class='confluenceTd'> Console output </td> <td class='confluenceTd'> <a href="https://builds.apache.org/job/PreCommit-MAPREDUCE-Build/6730/console" class="external-link" rel="nofollow">https://builds.apache.org/job/PreCommit-MAPREDUCE-Build/6730/console</a> </td> </tr> <tr> <td class='confluenceTd'> Powered by </td> <td class='confluenceTd'> Apache Yetus 0.3.0 <a href="http://yetus.apache.org" class="external-link" rel="nofollow">http://yetus.apache.org</a> </td> </tr> </tbody></table> <p>This message was automatically generated.</p>
</comment>
<comment id="15510781" author="rkanter" created="Wed, 21 Sep 2016 18:33:47 +0000">
<blockquote><p>Quite shocked that commit "9d4d30243b0fc" get merged without basic MRv2 test and even no YARN JIRA for it!</p></blockquote> <p><a href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tangzhankun" class="user-hover" rel="tangzhankun">Zhankun Tang</a>, commit "9d4d30243b0fc" when in to fix a security problem. That's why there's no JIRA and why it's shrouded in mystery. </p> <blockquote> <p>Who cares? It's all Apache Hadoop. Users have an expectation that this stuff will work out of the box and be consistent. They aren't going to say "Oh, of course this is completely broken! That part over there is YARN and that part over there is MAPREDUCE!"</p></blockquote> <p><a href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=aw" class="user-hover" rel="aw">Allen Wittenauer</a>, my original patch for "9d4d30243b0fc" did add <tt>HADOOP_MAPRED_HOME</tt> to Yarn and things did work out of the box. There was pushback to remove it because of the desire to keep Yarn and MR separate. Given the difficulty people seem to be having and that there doesn't seem to be a single fix that works for everyone for some reason, perhaps we should revisit that decision? </p>
</comment>
<comment id="15580329" author="yzhangal" created="Sun, 16 Oct 2016 18:14:46 +0000">
<p>HI Guys, </p> <p>Thanks for working on this issue here. Wonder if we had a consensus about the solution? Can we document the workaround before the solution is in place?</p> <p>Thanks.</p>
</comment>
<comment id="15580359" author="yzhangal" created="Sun, 16 Oct 2016 18:40:00 +0000">
<p>Per the discussion above, I added config</p> <div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent"> <pre class="code-java"> &lt;property&gt; &lt;name&gt;yarn.nodemanager.env-whitelist&lt;/name&gt; &lt;value&gt;=JAVA_HOME,HADOOP_COMMON_HOME,HADOOP_HDFS_HOME,HADOOP_CONF_DIR,CLASSPATH_PREPEND_DISTCACHE,HADOOP_YARN_HOME,HADOOP_MAPRED_HOME&lt;/value&gt; &lt;/property&gt; </pre> </div></div> <p>to yarn-site.xml</p> <p>and ran into the following issue</p> <div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent"> <pre class="code-java"> Container exited with a non-zero exit code 127. Last 4096 bytes of stderr : /bin/bash: /bin/java: No such file or directory </pre> </div></div> <p>Then I created a soft link from the java I am using to /bin/java, and it works now.</p> <p>It seems the code has a hardcoded dependency on the existence of /bin/java. Can we find the java in the path setting instead?</p> <p>Thanks.</p>
</comment>
<comment id="15582894" author="bibinchundatt" created="Mon, 17 Oct 2016 17:44:44 +0000">
<p><a href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=yzhangal" class="user-hover" rel="yzhangal">Yongjun Zhang</a><br/> Looks like you have made wrong configuration</p> <div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent"> <pre>&lt;value&gt;=JAVA_HOME </pre> </div></div> <p>Could please remove <tt>=</tt> and try again. I thought of documenting the white list parameter configuration and closing the issue waiting for +1 which solution to take.</p>
</comment>
<comment id="15583306" author="yzhangal" created="Mon, 17 Oct 2016 20:11:16 +0000">
<p>Thanks <a href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=bibinchundatt" class="user-hover" rel="bibinchundatt">Bibin A Chundatt</a>, good catch, and sorry for missing that earlier. I tried again after removing "+", it runs.</p>
</comment>
<comment id="15596201" author="andrew.wang" created="Fri, 21 Oct 2016 20:03:25 +0000">
<p>Folks, is there any progress we can make on this JIRA? That this doesn't work out of the box anymore has been very surprising to our users. I'd like to get it fixed for alpha2 if possible.</p>
</comment>
<comment id="15596876" author="bibinchundatt" created="Sat, 22 Oct 2016 01:18:40 +0000">
<p><a href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rkanter" class="user-hover" rel="rkanter">Robert Kanter</a></p> <blockquote> <p>Given the difficulty people seem to be having and that there doesn't seem to be a single fix that works for everyone for some reason, perhaps we should revisit that decision? </p></blockquote> <p>IMHO we have to rethink of the same.</p> <p>Summarizing discussion and solutions</p> <ol> <li>Add HADOOP_MAPRED_HOME=HADOOP_COMMON_HOME in opts.But its not mandatory that MAPRED_HOME=HADOOP_COMMON_HOME</li> <li>Add HADOOP_MAPRED_HOME to Yarn.Since we want to keep YARN and MAPRED separate initial solution was not accepted.</li> <li>Add documentation to configure yarn.nodemanager.env-whitelist in nodemanager to run mapred application <div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent"> <pre>&lt;property&gt; &lt;name&gt;yarn.nodemanager.env-whitelist&lt;/name&gt; &lt;value&gt;JAVA_HOME,HADOOP_COMMON_HOME,HADOOP_HDFS_HOME,HADOOP_CONF_DIR,CLASSPATH_PREPEND_DISTCACHE,HADOOP_YARN_HOME,HADOOP_MAPRED_HOME&lt;/value&gt; &lt;/property&gt; </pre> </div></div> <p>Waiting for +1 for any one of above solution or inputs for any other approach</p></li> </ol>
</comment>
<comment id="15599535" author="bibinchundatt" created="Sun, 23 Oct 2016 11:19:03 +0000">
<p>Solution 4:<br/> We should add option in YARN to support sending addition whitelist ENV as part of ContainerLaunchContext. Addition patch for solution 4 also <tt>container-whitelist-env-wip.patch</tt> . created a jira <a href="https://issues.apache.org/jira/browse/YARN-5771" title="Provide option to send env to be whitelisted in ContainerLaunchContext " class="issue-link" data-issue-key="YARN-5771">YARN-5771</a> also. </p>
</comment>
<comment id="15599787" author="hadoopqa" created="Sun, 23 Oct 2016 14:38:39 +0000">
<table class='confluenceTable'><tbody> <tr> <td class='confluenceTd'> <img class="emoticon" src="https://issues.apache.org/jira/images/icons/emoticons/error.gif" height="16" width="16" align="absmiddle" alt="" border="0"/> <b><font color="red">-1 overall</font></b> </td> </tr> </tbody></table> <p><br class="atl-forced-newline" /> <br class="atl-forced-newline" /></p> <table class='confluenceTable'><tbody> <tr> <th class='confluenceTh'> Vote </th> <th class='confluenceTh'> Subsystem </th> <th class='confluenceTh'> Runtime </th> <th class='confluenceTh'> Comment </th> </tr> <tr> <td class='confluenceTd'> <font color="blue">0</font> </td> <td class='confluenceTd'> <font color="blue"> reexec </font> </td> <td class='confluenceTd'> <font color="blue"> 0m 10s </font> </td> <td class='confluenceTd'> <font color="blue"> Docker mode activated. </font> </td> </tr> <tr> <td class='confluenceTd'> <font color="green">+1</font> </td> <td class='confluenceTd'> <font color="green"> @author </font> </td> <td class='confluenceTd'> <font color="green"> 0m 0s </font> </td> <td class='confluenceTd'> <font color="green"> The patch does not contain any @author tags. </font> </td> </tr> <tr> <td class='confluenceTd'> <font color="red">-1</font> </td> <td class='confluenceTd'> <font color="red"> test4tests </font> </td> <td class='confluenceTd'> <font color="red"> 0m 0s </font> </td> <td class='confluenceTd'> <font color="red"> The patch doesn't appear to include any new or modified tests. Please justify why no new tests are needed for this patch. Also please list what manual steps were performed to verify this patch. </font> </td> </tr> <tr> <td class='confluenceTd'> <font color="blue">0</font> </td> <td class='confluenceTd'> <font color="blue"> mvndep </font> </td> <td class='confluenceTd'> <font color="blue"> 0m 40s </font> </td> <td class='confluenceTd'> <font color="blue"> Maven dependency ordering for branch </font> </td> </tr> <tr> <td class='confluenceTd'> <font color="green">+1</font> </td> <td class='confluenceTd'> <font color="green"> mvninstall </font> </td> <td class='confluenceTd'> <font color="green"> 6m 52s </font> </td> <td class='confluenceTd'> <font color="green"> trunk passed </font> </td> </tr> <tr> <td class='confluenceTd'> <font color="green">+1</font> </td> <td class='confluenceTd'> <font color="green"> compile </font> </td> <td class='confluenceTd'> <font color="green"> 6m 45s </font> </td> <td class='confluenceTd'> <font color="green"> trunk passed </font> </td> </tr> <tr> <td class='confluenceTd'> <font color="green">+1</font> </td> <td class='confluenceTd'> <font color="green"> checkstyle </font> </td> <td class='confluenceTd'> <font color="green"> 1m 36s </font> </td> <td class='confluenceTd'> <font color="green"> trunk passed </font> </td> </tr> <tr> <td class='confluenceTd'> <font color="green">+1</font> </td> <td class='confluenceTd'> <font color="green"> mvnsite </font> </td> <td class='confluenceTd'> <font color="green"> 2m 46s </font> </td> <td class='confluenceTd'> <font color="green"> trunk passed </font> </td> </tr> <tr> <td class='confluenceTd'> <font color="green">+1</font> </td> <td class='confluenceTd'> <font color="green"> mvneclipse </font> </td> <td class='confluenceTd'> <font color="green"> 1m 21s </font> </td> <td class='confluenceTd'> <font color="green"> trunk passed </font> </td> </tr> <tr> <td class='confluenceTd'> <font color="green">+1</font> </td> <td class='confluenceTd'> <font color="green"> findbugs </font> </td> <td class='confluenceTd'> <font color="green"> 4m 18s </font> </td> <td class='confluenceTd'> <font color="green"> trunk passed </font> </td> </tr> <tr> <td class='confluenceTd'> <font color="green">+1</font> </td> <td class='confluenceTd'> <font color="green"> javadoc </font> </td> <td class='confluenceTd'> <font color="green"> 1m 48s </font> </td> <td class='confluenceTd'> <font color="green"> trunk passed </font> </td> </tr> <tr> <td class='confluenceTd'> <font color="blue">0</font> </td> <td class='confluenceTd'> <font color="blue"> mvndep </font> </td> <td class='confluenceTd'> <font color="blue"> 0m 14s </font> </td> <td class='confluenceTd'> <font color="blue"> Maven dependency ordering for patch </font> </td> </tr> <tr> <td class='confluenceTd'> <font color="green">+1</font> </td> <td class='confluenceTd'> <font color="green"> mvninstall </font> </td> <td class='confluenceTd'> <font color="green"> 2m 12s </font> </td> <td class='confluenceTd'> <font color="green"> the patch passed </font> </td> </tr> <tr> <td class='confluenceTd'> <font color="green">+1</font> </td> <td class='confluenceTd'> <font color="green"> compile </font> </td> <td class='confluenceTd'> <font color="green"> 6m 44s </font> </td> <td class='confluenceTd'> <font color="green"> the patch passed </font> </td> </tr> <tr> <td class='confluenceTd'> <font color="green">+1</font> </td> <td class='confluenceTd'> <font color="green"> cc </font> </td> <td class='confluenceTd'> <font color="green"> 6m 44s </font> </td> <td class='confluenceTd'> <font color="green"> the patch passed </font> </td> </tr> <tr> <td class='confluenceTd'> <font color="green">+1</font> </td> <td class='confluenceTd'> <font color="green"> javac </font> </td> <td class='confluenceTd'> <font color="green"> 6m 44s </font> </td> <td class='confluenceTd'> <font color="green"> the patch passed </font> </td> </tr> <tr> <td class='confluenceTd'> <font color="red">-1</font> </td> <td class='confluenceTd'> <font color="red"> checkstyle </font> </td> <td class='confluenceTd'> <font color="red"> 1m 38s </font> </td> <td class='confluenceTd'> <font color="red"> root: The patch generated 8 new + 865 unchanged - 3 fixed = 873 total (was 868) </font> </td> </tr> <tr> <td class='confluenceTd'> <font color="green">+1</font> </td> <td class='confluenceTd'> <font color="green"> mvnsite </font> </td> <td class='confluenceTd'> <font color="green"> 2m 45s </font> </td> <td class='confluenceTd'> <font color="green"> the patch passed </font> </td> </tr> <tr> <td class='confluenceTd'> <font color="green">+1</font> </td> <td class='confluenceTd'> <font color="green"> mvneclipse </font> </td> <td class='confluenceTd'> <font color="green"> 1m 20s </font> </td> <td class='confluenceTd'> <font color="green"> the patch passed </font> </td> </tr> <tr> <td class='confluenceTd'> <font color="green">+1</font> </td> <td class='confluenceTd'> <font color="green"> whitespace </font> </td> <td class='confluenceTd'> <font color="green"> 0m 0s </font> </td> <td class='confluenceTd'> <font color="green"> The patch has no whitespace issues. </font> </td> </tr> <tr> <td class='confluenceTd'> <font color="green">+1</font> </td> <td class='confluenceTd'> <font color="green"> findbugs </font> </td> <td class='confluenceTd'> <font color="green"> 5m 1s </font> </td> <td class='confluenceTd'> <font color="green"> the patch passed </font> </td> </tr> <tr> <td class='confluenceTd'> <font color="green">+1</font> </td> <td class='confluenceTd'> <font color="green"> javadoc </font> </td> <td class='confluenceTd'> <font color="green"> 1m 49s </font> </td> <td class='confluenceTd'> <font color="green"> the patch passed </font> </td> </tr> <tr> <td class='confluenceTd'> <font color="green">+1</font> </td> <td class='confluenceTd'> <font color="green"> unit </font> </td> <td class='confluenceTd'> <font color="green"> 0m 24s </font> </td> <td class='confluenceTd'> <font color="green"> hadoop-yarn-api in the patch passed. </font> </td> </tr> <tr> <td class='confluenceTd'> <font color="green">+1</font> </td> <td class='confluenceTd'> <font color="green"> unit </font> </td> <td class='confluenceTd'> <font color="green"> 2m 16s </font> </td> <td class='confluenceTd'> <font color="green"> hadoop-yarn-common in the patch passed. </font> </td> </tr> <tr> <td class='confluenceTd'> <font color="red">-1</font> </td> <td class='confluenceTd'> <font color="red"> unit </font> </td> <td class='confluenceTd'> <font color="red"> 14m 43s </font> </td> <td class='confluenceTd'> <font color="red"> hadoop-yarn-server-nodemanager in the patch failed. </font> </td> </tr> <tr> <td class='confluenceTd'> <font color="green">+1</font> </td> <td class='confluenceTd'> <font color="green"> unit </font> </td> <td class='confluenceTd'> <font color="green"> 2m 27s </font> </td> <td class='confluenceTd'> <font color="green"> hadoop-mapreduce-client-core in the patch passed. </font> </td> </tr> <tr> <td class='confluenceTd'> <font color="green">+1</font> </td> <td class='confluenceTd'> <font color="green"> unit </font> </td> <td class='confluenceTd'> <font color="green"> 8m 31s </font> </td> <td class='confluenceTd'> <font color="green"> hadoop-mapreduce-client-app in the patch passed. </font> </td> </tr> <tr> <td class='confluenceTd'> <font color="green">+1</font> </td> <td class='confluenceTd'> <font color="green"> unit </font> </td> <td class='confluenceTd'> <font color="green"> 111m 23s </font> </td> <td class='confluenceTd'> <font color="green"> hadoop-mapreduce-client-jobclient in the patch passed. </font> </td> </tr> <tr> <td class='confluenceTd'> <font color="green">+1</font> </td> <td class='confluenceTd'> <font color="green"> asflicense </font> </td> <td class='confluenceTd'> <font color="green"> 0m 31s </font> </td> <td class='confluenceTd'> <font color="green"> The patch does not generate ASF License warnings. </font> </td> </tr> <tr> <td class='confluenceTd'> <font color="black"></font> </td> <td class='confluenceTd'> <font color="black"> </font> </td> <td class='confluenceTd'> <font color="black"> 189m 53s </font> </td> <td class='confluenceTd'> <font color="black"> </font> </td> </tr> </tbody></table> <p><br class="atl-forced-newline" /> <br class="atl-forced-newline" /></p> <table class='confluenceTable'><tbody> <tr> <th class='confluenceTh'> Reason </th> <th class='confluenceTh'> Tests </th> </tr> <tr> <td class='confluenceTd'> Failed junit tests </td> <td class='confluenceTd'> hadoop.yarn.server.nodemanager.containermanager.queuing.TestQueuingContainerManager </td> </tr> </tbody></table> <p><br class="atl-forced-newline" /> <br class="atl-forced-newline" /></p> <table class='confluenceTable'><tbody> <tr> <th class='confluenceTh'> Subsystem </th> <th class='confluenceTh'> Report/Notes </th> </tr> <tr> <td class='confluenceTd'> Docker </td> <td class='confluenceTd'> Image:yetus/hadoop:9560f25 </td> </tr> <tr> <td class='confluenceTd'> JIRA Patch URL </td> <td class='confluenceTd'> <a href="https://issues.apache.org/jira/secure/attachment/12834840/container-whitelist-env-wip.patch" class="external-link" rel="nofollow">https://issues.apache.org/jira/secure/attachment/12834840/container-whitelist-env-wip.patch</a> </td> </tr> <tr> <td class='confluenceTd'> JIRA Issue </td> <td class='confluenceTd'> <a href="https://issues.apache.org/jira/browse/MAPREDUCE-6704" title="Container fail to launch for mapred application" class="issue-link" data-issue-key="MAPREDUCE-6704">MAPREDUCE-6704</a> </td> </tr> <tr> <td class='confluenceTd'> Optional Tests </td> <td class='confluenceTd'> asflicense compile javac javadoc mvninstall mvnsite unit findbugs checkstyle cc </td> </tr> <tr> <td class='confluenceTd'> uname </td> <td class='confluenceTd'> Linux bace1b096a29 3.13.0-93-generic #140-Ubuntu SMP Mon Jul 18 21:21:05 UTC 2016 x86_64 x86_64 x86_64 GNU/Linux </td> </tr> <tr> <td class='confluenceTd'> Build tool </td> <td class='confluenceTd'> maven </td> </tr> <tr> <td class='confluenceTd'> Personality </td> <td class='confluenceTd'> /testptch/hadoop/patchprocess/precommit/personality/provided.sh </td> </tr> <tr> <td class='confluenceTd'> git revision </td> <td class='confluenceTd'> trunk / d4725bf </td> </tr> <tr> <td class='confluenceTd'> Default Java </td> <td class='confluenceTd'> 1.8.0_101 </td> </tr> <tr> <td class='confluenceTd'> findbugs </td> <td class='confluenceTd'> v3.0.0 </td> </tr> <tr> <td class='confluenceTd'> checkstyle </td> <td class='confluenceTd'> <a href="https://builds.apache.org/job/PreCommit-MAPREDUCE-Build/6771/artifact/patchprocess/diff-checkstyle-root.txt" class="external-link" rel="nofollow">https://builds.apache.org/job/PreCommit-MAPREDUCE-Build/6771/artifact/patchprocess/diff-checkstyle-root.txt</a> </td> </tr> <tr> <td class='confluenceTd'> unit </td> <td class='confluenceTd'> <a href="https://builds.apache.org/job/PreCommit-MAPREDUCE-Build/6771/artifact/patchprocess/patch-unit-hadoop-yarn-project_hadoop-yarn_hadoop-yarn-server_hadoop-yarn-server-nodemanager.txt" class="external-link" rel="nofollow">https://builds.apache.org/job/PreCommit-MAPREDUCE-Build/6771/artifact/patchprocess/patch-unit-hadoop-yarn-project_hadoop-yarn_hadoop-yarn-server_hadoop-yarn-server-nodemanager.txt</a> </td> </tr> <tr> <td class='confluenceTd'> unit test logs </td> <td class='confluenceTd'> <a href="https://builds.apache.org/job/PreCommit-MAPREDUCE-Build/6771/artifact/patchprocess/patch-unit-hadoop-yarn-project_hadoop-yarn_hadoop-yarn-server_hadoop-yarn-server-nodemanager.txt" class="external-link" rel="nofollow">https://builds.apache.org/job/PreCommit-MAPREDUCE-Build/6771/artifact/patchprocess/patch-unit-hadoop-yarn-project_hadoop-yarn_hadoop-yarn-server_hadoop-yarn-server-nodemanager.txt</a> </td> </tr> <tr> <td class='confluenceTd'> Test Results </td> <td class='confluenceTd'> <a href="https://builds.apache.org/job/PreCommit-MAPREDUCE-Build/6771/testReport/" class="external-link" rel="nofollow">https://builds.apache.org/job/PreCommit-MAPREDUCE-Build/6771/testReport/</a> </td> </tr> <tr> <td class='confluenceTd'> modules </td> <td class='confluenceTd'> C: hadoop-yarn-project/hadoop-yarn/hadoop-yarn-api hadoop-yarn-project/hadoop-yarn/hadoop-yarn-common hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-nodemanager hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-core hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-app hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-jobclient U: . </td> </tr> <tr> <td class='confluenceTd'> Console output </td> <td class='confluenceTd'> <a href="https://builds.apache.org/job/PreCommit-MAPREDUCE-Build/6771/console" class="external-link" rel="nofollow">https://builds.apache.org/job/PreCommit-MAPREDUCE-Build/6771/console</a> </td> </tr> <tr> <td class='confluenceTd'> Powered by </td> <td class='confluenceTd'> Apache Yetus 0.3.0 <a href="http://yetus.apache.org" class="external-link" rel="nofollow">http://yetus.apache.org</a> </td> </tr> </tbody></table> <p>This message was automatically generated.</p>
</comment>
<comment id="15612421" author="templedf" created="Thu, 27 Oct 2016 16:30:09 +0000">
<p>+1 to #3, but <b>making it the default</b>, not just documenting it. I agree with <a href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=aw" class="user-hover" rel="aw">Allen Wittenauer</a> that a little pollution is OK if it makes the out-of-box experience significantly better. And I don't think spilling over an environment variable is so bad anyway.</p> <p>#1 has several issues. In addition to what was already stated, the vars are evaluated on the client, so if the client doesn't have the same paths as the NM hosts, it won't work.</p> <p>#2 is a code-level pollution, which is a more serious thing than #3.</p> <p>#4 doesn't sound like the right idea to me. Users don't need to control the whitelisting on a per-job basis, so it's solving a problem that doesn't exist. It also has some security implications that need to be carefully considered.</p>
</comment>
<comment id="15615461" author="templedf" created="Fri, 28 Oct 2016 13:48:34 +0000">
<p>As if we're not split enough on this decision, let me throw in one more option.</p> <p>The final and correct answer is that users should set up distributed cache deployment (per <a href="https://hadoop.apache.org/docs/r3.0.0-alpha1/hadoop-mapreduce-client/hadoop-mapreduce-client-core/DistributedCacheDeploy.html" class="external-link" rel="nofollow">https://hadoop.apache.org/docs/r3.0.0-alpha1/hadoop-mapreduce-client/hadoop-mapreduce-client-core/DistributedCacheDeploy.html</a>). At that point things just work, and upgrades become simpler. The problem is that distributed cache deployment isn't an option for out of the box.</p> <p>Spark does not have the problem we're trying to solve here. Every time you submit a Spark application, they ship the assembly JAR via the distributed cache. If we want to push users to distributed cache deployment, maybe the way to solve the out-of-box problem is the light version of dist cache deployment: -libjars.</p> <p>Option #5) Add a MapReduce property that controls whether the MapReduce JARs are automatically shipped with the job via -libjars, and turn it on by default. Yes, it's inefficient (in both time and space), but it works out of the box and is a natural segue into dist cache deployment.</p>
</comment>
<comment id="15616663" author="rkanter" created="Fri, 28 Oct 2016 21:37:22 +0000">
<p>Either #3 (adding <tt>HADOOP_MAPRED_HOME</tt> to the classpath) or #5 (though maybe not actually using <tt>-libjars</tt> argument, but doing something equivalent) sound good to me.</p>
</comment>
<comment id="15617802" author="bibinchundatt" created="Sat, 29 Oct 2016 09:18:18 +0000">
<p> Thank you <a href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=templedf" class="user-hover" rel="templedf">Daniel Templeton</a> and <a href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rkanter" class="user-hover" rel="rkanter">Robert Kanter</a> for inputs</p> <p>#3 since for upgrade case when we have running apps and havnt used distributed cache.<br/> Need to modify only one config during upgrade and everything works as old. <br/> Another case can happen when old clients try to submit apps too rt?</p> <blockquote> <p>client doesn't have the same paths as the NM hosts, it won't work.</p></blockquote> <p><a href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=templedf" class="user-hover" rel="templedf">Daniel Templeton</a> Thank you for bring this scenarios too had missed out.</p> <p>Will do document update and upload patch soon.</p>
</comment>
<comment id="15625447" author="templedf" created="Tue, 1 Nov 2016 13:33:44 +0000">
<p>Since this is a rather core issue, I'd love to see some additional opinions here. <a href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=andrew.wang" class="user-hover" rel="andrew.wang">Andrew Wang</a>, <a href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=varun_saxena" class="user-hover" rel="varun_saxena">Varun Saxena</a>, <a href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ajisakaa" class="user-hover" rel="ajisakaa">Akira Ajisaka</a>, <a href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sjlee0" class="user-hover" rel="sjlee0">Sangjin Lee</a>, <a href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sunilg" class="user-hover" rel="sunilg">Sunil G</a>, <a href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Naganarasimha" class="user-hover" rel="Naganarasimha">Naganarasimha G R</a>, <a href="https://issues.apache.org/jira/secure/ViewProfile.jspa?name=vinodkv" class="user-hover" rel="vinodkv">Vinod Kumar Vavilapalli</a>, any thoughts? Should we take this to the mailing list for more visibility?</p>
</comment>
<comment id="15626604" author="sjlee0" created="Tue, 1 Nov 2016 20:36:28 +0000">
<p>I am +1 for #3. There is the yuck factor of mixing up MR into YARN, but the issue is significant enough and the change small enough that I think we can make an exception here.</p> <p>We can move the discussion to the mailing list to expand the audience.</p>
</comment>
<comment id="15627640" author="ajisakaa" created="Wed, 2 Nov 2016 04:19:48 +0000">
<p>+1 for #3.<br/> In <a href="https://issues.apache.org/jira/browse/MAPREDUCE-6702" title="TestMiniMRChildTask.testTaskEnv and TestMiniMRChildTask.testTaskOldEnv are failing" class="issue-link" data-issue-key="MAPREDUCE-6702"><del>MAPREDUCE-6702</del></a>, I wrote a patch to document that we need to set <tt>HADOOP_MAPRED_HOME=$HADOOP_COMMON_HOME</tt> to mapreduce.admin.user.env and yarn.app.mapreduce.am.env, but HADOOP_MAPRED_HOME is not always as same as HADOOP_COMMON_HOME. I'm thinking it's better to set yarn.nodemanager.env-whitelist instead of setting these parameters.</p>
</comment>
<comment id="15629641" author="templedf" created="Wed, 2 Nov 2016 17:09:11 +0000">
<p>Yep. I was planning to submit a JIRA this morning to make exactly that change.</p>
</comment>
<comment id="15635159" author="bibinchundatt" created="Fri, 4 Nov 2016 04:08:50 +0000">
<p>Thank you all . Attaching patch based on solution 3</p>
</comment>
<comment id="15635184" author="hadoopqa" created="Fri, 4 Nov 2016 04:24:13 +0000">
<table class='confluenceTable'><tbody> <tr> <td class='confluenceTd'> <img class="emoticon" src="https://issues.apache.org/jira/images/icons/emoticons/check.gif" height="16" width="16" align="absmiddle" alt="" border="0"/> <b><font color="green">+1 overall</font></b> </td> </tr> </tbody></table> <p><br class="atl-forced-newline" /> <br class="atl-forced-newline" /></p> <table class='confluenceTable'><tbody> <tr> <th class='confluenceTh'> Vote </th> <th class='confluenceTh'> Subsystem </th> <th class='confluenceTh'> Runtime </th> <th class='confluenceTh'> Comment </th> </tr> <tr> <td class='confluenceTd'> <font color="blue">0</font> </td> <td class='confluenceTd'> <font color="blue"> reexec </font> </td> <td class='confluenceTd'> <font color="blue"> 0m 14s </font> </td> <td class='confluenceTd'> <font color="blue"> Docker mode activated. </font> </td> </tr> <tr> <td class='confluenceTd'> <font color="green">+1</font> </td> <td class='confluenceTd'> <font color="green"> @author </font> </td> <td class='confluenceTd'> <font color="green"> 0m 0s </font> </td> <td class='confluenceTd'> <font color="green"> The patch does not contain any @author tags. </font> </td> </tr> <tr> <td class='confluenceTd'> <font color="green">+1</font> </td> <td class='confluenceTd'> <font color="green"> mvninstall </font> </td> <td class='confluenceTd'> <font color="green"> 8m 25s </font> </td> <td class='confluenceTd'> <font color="green"> trunk passed </font> </td> </tr> <tr> <td class='confluenceTd'> <font color="green">+1</font> </td> <td class='confluenceTd'> <font color="green"> mvnsite </font> </td> <td class='confluenceTd'> <font color="green"> 1m 2s </font> </td> <td class='confluenceTd'> <font color="green"> trunk passed </font> </td> </tr> <tr> <td class='confluenceTd'> <font color="green">+1</font> </td> <td class='confluenceTd'> <font color="green"> mvnsite </font> </td> <td class='confluenceTd'> <font color="green"> 1m 2s </font> </td> <td class='confluenceTd'> <font color="green"> the patch passed </font> </td> </tr> <tr> <td class='confluenceTd'> <font color="green">+1</font> </td> <td class='confluenceTd'> <font color="green"> whitespace </font> </td> <td class='confluenceTd'> <font color="green"> 0m 0s </font> </td> <td class='confluenceTd'> <font color="green"> The patch has no whitespace issues. </font> </td> </tr> <tr> <td class='confluenceTd'> <font color="green">+1</font> </td> <td class='confluenceTd'> <font color="green"> asflicense </font> </td> <td class='confluenceTd'> <font color="green"> 0m 22s </font> </td> <td class='confluenceTd'> <font color="green"> The patch does not generate ASF License warnings. </font> </td> </tr> <tr> <td class='confluenceTd'> <font color="black"></font> </td> <td class='confluenceTd'> <font color="black"> </font> </td> <td class='confluenceTd'> <font color="black"> 11m 20s </font> </td> <td class='confluenceTd'> <font color="black"> </font> </td> </tr> </tbody></table> <p><br class="atl-forced-newline" /> <br class="atl-forced-newline" /></p> <table class='confluenceTable'><tbody> <tr> <th class='confluenceTh'> Subsystem </th> <th class='confluenceTh'> Report/Notes </th> </tr> <tr> <td class='confluenceTd'> Docker </td> <td class='confluenceTd'> Image:yetus/hadoop:9560f25 </td> </tr> <tr> <td class='confluenceTd'> JIRA Patch URL </td> <td class='confluenceTd'> <a href="https://issues.apache.org/jira/secure/attachment/12837039/MAPREDUCE-6704.0002.patch" class="external-link" rel="nofollow">https://issues.apache.org/jira/secure/attachment/12837039/MAPREDUCE-6704.0002.patch</a> </td> </tr> <tr> <td class='confluenceTd'> JIRA Issue </td> <td class='confluenceTd'> <a href="https://issues.apache.org/jira/browse/MAPREDUCE-6704" title="Container fail to launch for mapred application" class="issue-link" data-issue-key="MAPREDUCE-6704">MAPREDUCE-6704</a> </td> </tr> <tr> <td class='confluenceTd'> Optional Tests </td> <td class='confluenceTd'> asflicense mvnsite </td> </tr> <tr> <td class='confluenceTd'> uname </td> <td class='confluenceTd'> Linux 3866c2eb9814 3.13.0-93-generic #140-Ubuntu SMP Mon Jul 18 21:21:05 UTC 2016 x86_64 x86_64 x86_64 GNU/Linux </td> </tr> <tr> <td class='confluenceTd'> Build tool </td> <td class='confluenceTd'> maven </td> </tr> <tr> <td class='confluenceTd'> Personality </td> <td class='confluenceTd'> /testptch/hadoop/patchprocess/precommit/personality/provided.sh </td> </tr> <tr> <td class='confluenceTd'> git revision </td> <td class='confluenceTd'> trunk / 69dd5fa </td> </tr> <tr> <td class='confluenceTd'> modules </td> <td class='confluenceTd'> C: hadoop-common-project/hadoop-common U: hadoop-common-project/hadoop-common </td> </tr> <tr> <td class='confluenceTd'> Console output </td> <td class='confluenceTd'> <a href="https://builds.apache.org/job/PreCommit-MAPREDUCE-Build/6796/console" class="external-link" rel="nofollow">https://builds.apache.org/job/PreCommit-MAPREDUCE-Build/6796/console</a> </td> </tr> <tr> <td class='confluenceTd'> Powered by </td> <td class='confluenceTd'> Apache Yetus 0.3.0 <a href="http://yetus.apache.org" class="external-link" rel="nofollow">http://yetus.apache.org</a> </td> </tr> </tbody></table> <p>This message was automatically generated.</p>
</comment>
</comments>
<issuelinks>
<issuelinktype id="12310000">
<name>Duplicate</name>
<outwardlinks description="duplicates">
<issuelink>
<issuekey id="13008204">MAPREDUCE-6783</issuekey>
</issuelink>
</outwardlinks>
</issuelinktype>
<issuelinktype id="10030">
<name>Reference</name>
<outwardlinks description="relates to">
<issuelink>
<issuekey id="12970557">MAPREDUCE-6702</issuekey>
</issuelink>
</outwardlinks>
</issuelinktype>
</issuelinks>
<attachments>
<attachment id="12809399" name="0001-MAPREDUCE-6704.patch" size="4302" author="bibinchundatt" created="Fri, 10 Jun 2016 08:53:22 +0000"/>
<attachment id="12801943" name="0001-YARN-5026.patch" size="3641" author="bibinchundatt" created="Tue, 3 May 2016 12:48:10 +0000"/>
<attachment id="12837039" name="MAPREDUCE-6704.0002.patch" size="3023" author="bibinchundatt" created="Fri, 4 Nov 2016 04:08:50 +0000"/>
<attachment id="12834840" name="container-whitelist-env-wip.patch" size="13541" author="bibinchundatt" created="Sun, 23 Oct 2016 11:19:03 +0000"/>
</attachments>
<subtasks></subtasks>
<customfields>
<customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
<customfieldname>Attachment count</customfieldname>
<customfieldvalues>
<customfieldvalue>4.0</customfieldvalue>
</customfieldvalues>
</customfield>
<customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
<customfieldname>Date of First Response</customfieldname>
<customfieldvalues>
<customfieldvalue>Mon, 2 May 2016 13:22:27 +0000</customfieldvalue>
</customfieldvalues>
</customfield>
<customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
<customfieldname>Global Rank</customfieldname>
<customfieldvalues>
<customfieldvalue>9223372036854775807</customfieldvalue>
</customfieldvalues>
</customfield>
<customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
<customfieldname>Last public comment date</customfieldname>
<customfieldvalues>1 hour ago</customfieldvalues>
</customfield>
<customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
<customfieldname>Rank</customfieldname>
<customfieldvalues>
<customfieldvalue>0|i2x1gf:</customfieldvalue>
</customfieldvalues>
</customfield>
<customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
<customfieldname>Rank (Obsolete)</customfieldname>
<customfieldvalues>
<customfieldvalue>9223372036854775807</customfieldvalue>
</customfieldvalues>
</customfield>
<customfield id="customfield_12310320" key="com.atlassian.jira.plugin.system.customfieldtypes:multiversion">
<customfieldname>Target Version/s</customfieldname>
<customfieldvalues>
<customfieldvalue>12337977</customfieldvalue>
</customfieldvalues>
</customfield>
</customfields>
</item>
</channel>
</rss>
