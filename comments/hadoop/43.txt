Thank you all . Attaching patch based on solution 3